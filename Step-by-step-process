Step1:

Fork the repository:

https://github.com/Sonal0409/Vodafone-DevOps-CapstoneProject.git

The above repository contains source code and test cases of a spring boot project
==========================================================================

Step 2: We will write github actions workflow YAML file to Build the code using Maven

Execute below  steps:

 > In the repository -> click on Actions Tab --> Choose a Workflow --> Setup and workflow yourself

 > A new Yaml file will open--> give name as ContinousIntegration.yml

 > Add the below YAML code


name: Capstone project CICD pipeline
on: 
 push:
jobs:
 capstoneproject:
 runs-on: ubuntu-latest
 steps:
  - name: Checkout the code
    uses: actions/checkout@v4
  - name: Install Java and Maven
    uses: actions/setup-java@v4
    with:
    distribution: 'temurin'
    java-version: '11'
    cache: maven
  - name: Build the code
    run: mvn package --file pom.xml

Step 3: We will now create a dockerfile and then build image using github actions. 
        We will also push the image to dockerhub using github Actions

Execute below  steps:

 > In the repository create a new file with name as Dockerfile

Add the below lines in the dockerfile and save the file


FROM tomcat:8
COPY target/java-example.war /usr/local/tomcat/webapps/ROOT.war
EXPOSE 8080
CMD ["catalina.sh", "run"]


Save the file

> As we have to push the image to dockerhub, we will create secrets in the repository to save dockerhub username and dockerhub password

> For this go to Settings tab of repository > go to secrets and variables > click on to Actions > Secrets Tab > Repository secrets > click on new repository secret

	> give name as DOCKERHUB_USERNAME ==> Secret as > your dockerhub username > Click on Add secret

	> Again  click on new repository secret > give name as DOCKERHUB_TOKEN > Secret as > your dockerhub password> click on add secret

	> Give the secret names in UPPERCASE, as we use the same secret name in the actions YAML file.


> In the repository > now go to .github/workflow folder --> you will find the main.yml file

> Click on Edit the file 

> Replace the content of the file with below content. 

name: Capstone project CICD pipeline
on: 
 push:
jobs:
 capstoneproject:
  runs-on: ubuntu-latest
  steps:
  - name: Checkout the code
    uses: actions/checkout@v4
  - name: Install Java and Maven
    uses: actions/setup-java@v4
    with:
     distribution: 'temurin'
     java-version: '11'
     cache: maven
  - name: Build the code
    run: mvn package --file pom.xml
  - name: Install docker
    uses: docker/setup-buildx-action@v3
  - name: Login to dockerhub
    uses: docker/login-action@v2
    with:
     username: ${{ secrets.DOCKERHUB_USERNAME }}
     password: ${{ secrets.DOCKERHUB_TOKEN }}
  - name: Build and Push the Image
    uses: docker/build-push-action@v4
    with:
     context: .
     push: true 
     tags: ${{ secrets.DOCKERHUB_USERNAME }}/capstoneimage:latest


Step 4: Create kubernetes Helm chart to deploy above image and push charts to github repo

> Connect to devOps lab > here we will install helm 

Execute below commands:
# sudo su -
# curl https://raw.githubusercontent.com/kubernetes/helm/master/scripts/get-helm-3 > get_helm.sh
# chmod 700 get_helm.sh
# ./get_helm.sh




